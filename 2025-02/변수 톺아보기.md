# Intro

안녕하세요! 자칭 소프트웨어 잡부 손우진입니다.

현재 Spring Boot나 Nest.js, DJango, React.js 등 수 많은 오픈소스 프레임워크 덕분에 백지부터 소프트웨어를 개발 할 필요가 없어졌어요. 우린 프레임워크가 제공해주는 도구들을 코딩을 통해 가져오고 붙히고 만들고 테스트하죠.
***'바퀴를 발명하지 말라!'*** 라는 말 잘 아실거에요. 우리가 만들고자 하는 소프트웨어에 바퀴 역할을 하는 것들 까지 직접 개발 할 필요는 없다는 의미입니다.
게다가 최근엔 AI가 너무 잘 되어 있어서, 때로는 우리가 직접 코딩을 하지 않고 설계만 잘 해두더라도 좋은 소프트웨어가 나오곤 합니다. 저도 개발할 때 Chat.gpt 에게 가끔 코딩을 맡기고는 해요.
이런 환경은 때로는 **우리가 잊고 있었던, 또는 모르고 있었던 지식들에 더욱 그림자를 씌웁니다.**

우리가 잘 사용하고 있지만, 때로는 ***블랙박스***로 사용하고 있는 지식들은 언젠가 문제를 일으킵니다.
오작동 했을 때 대처할 방법을 모르게 된다면, 생각했던 것 보다 스스로의 표정이 더 일그러지겠죠.
AI 에게 코딩을 맡겼다고 한들, 막상 이슈가 생겼을 때 까지 AI에게 도움을 요청할 수 없습니다. 현재로써 생성형 AI는 검색을 도와주는 도구 일 뿐이니까요.

그래서 이번에는 기존에 작성하던 글에 비해 조금 로우레벨로 내려가볼 까 합니다. 변수라는 키워드로 한번 포스팅을 해볼까 해요. **변수란 무엇인 지, 변수가 어떻게 동작하는 지 가볍지만 약간 깊게 다뤄볼까 합니다.**

# 정보(Information) VS 자료(Data)

컴퓨터공학 전공인 분들은 아마 학부 4년간 겪으셨겠지만, 프로그래밍의 핵심은 데이터를 메모리에 적재하고 필요할 때 꺼내 사용하는 것입니다.
아무리 화려한 기술을 쓴다고 해도 해당 틀에서 크게 벗어나지는 않아요.

이 데이터는 크게 정보와 자료로 나뉩니다. **정보** 는 의미가 있는 데이터, **자료** 는 데이터 그 자체입니다.

우리가 변수를 선언해서 데이터를 할당하면, 변수 그 자체는 정보가 됩니다.

```kotlin
val age : Int = 10
```

우리가 10이라는 데이터에 age 라는 의미를 부여했기 때문에 코드를 읽는 입장에서는 10이라는 데이터가 나이라는 것을 알 수 있는 셈이죠.

'변수 네이밍이 중요하다.' 라는 말은 단순히 클린코드, 즉 읽기 쉬운 코드를 위해서만은 아닙니다. 컴퓨터 입장에서는 변수 명이 뭐가 되었든 아무런 상관이 없어요. 우리가 변수명을 이상하게 짓는다고 한들 소프트웨어 동작에는 아무런 문제가 없어요. 하지만, 우리는 이 **자료** 의 의미를 알 수 없죠.

변수는 우리가 의미를 부여한 자료를 의미합니다.

# 자료형 (Data Type)

자료형은 정수형, 실수형, 문자열 등 데이터의 형태에 따라 나눠집니다.
크게는 정수형, 실수형, 문자열을 많이 쓰죠. 상황에 따라선 바이너리 형태로도 쓰입니다. REST API 요청을 처리하는 과정에서 URL을 할당 해 두었다고 한들, 요청을 처음 받은 입장에서부터 데이터가 무엇인 지 알 수가 없죠. (만약 알았다면 수 많은 악성 요청들을 막을 수 있을겁니다.)

OSI 7 Layer 상에서 우리의 애플리케이션은 가장 윗 단계인 7Layer 에 존재합니다. 통신 프로토콜을 타고 애플리케이션 레이어에서 이 데이터를 분석하려면 처음엔 바이너리 형태로 되어있죠. 바이너리 형태의 데이터를 우리가 받고자 하는 데이터 형태에 맞게 파싱하는데 Spring 에서는 이 과정에서 `HttpMessageConverter` 가 사용됩니다.

자료형은 흔히 관례적으로 쓰이는 명칭들이 존재합니다. C언어를 공부하던 시절로 한번 되돌아가볼까요?

정수형 자료형은 아래와 같습니다.

| 자료형                    | 크기(byte) | 최솟값               | 최대값              |
| ------------------------- | ---------- | -------------------- | ------------------- |
| short                     | 2          | -32768               | 32767               |
| int                       | 4          | -2147483648          | 2147483647          |
| long                      | 4          | -2147483648          | 2147483647          |
| long long                 | 8          | -9223372036854775808 | 9223372036854775807 |
| 실수형은 아래와 같습니다. |            |                      |                     |

| 자료형                    | 크기(byte) | 최솟값      | 최대값     |
| ------------------------- | ---------- | ----------- | ---------- |
| float                     | 4          | -3.4*10^38  | 3.4*10^38  |
| double                    | 8          | -1.8*10^308 | 1.8*10^308 |
| long double               | 8          | -1.8*10^308 | 1.8*10^308 |
| 문자형은 아래와 같습니다. |            |             |            |

| 자료형 | 크기(byte) | 최솟값 | 최대값 |
| ------ | ---------- | ------ | ------ |
| char   | 1          | -128   | 127    |

이런 내용들은 전공 시간에 많이들 다룹니다. 시험 문제로 내기도 딱 좋죠. 실제로 C언어 시험에서 나왔던 기억이 납니다. 데이터의 범위가 어디까지인 지 아는 건 중요하니까요.

자료형들을 선언해서 사용하다보면 이런 자료형들에 왜 이런 이름이 붙게 되었는 지 호기심이 들곤 합니다. 전 학부시절에 처음에는 상당히 기계적으로 받아들이다가 어느 시점에서 궁금해서 찾아 본 적이 있었습니다.

막간을 이용해 정리 해 볼까요?

정수형 int 는 아실 분은 잘 아시겠지만 Integer 의 준말이죠. Integer 그 자체는 정수라는 의미를 가지는 영어단어입니다.

그럼 short 과 long 은 무슨 의미일까요? 정말 어이없게도 메모리 공간을 적게 (short), 혹은 많이 (long) 차지한다는 의미로 붙었습니다.

정수형은 생각보다 평범합니다. 하지만 실수형은 조금 다릅니다. 우리가 알고있는 실수 (Real) 와 연관 되어보이는 단어가 들어가있지 않습니다.

실수형은 언어에 따라 조금 씩 차이는 나지만 크게 두가지 타입으로 나뉩니다. float 와 double이죠.

float 라는 단어 뜻에는 뜨다 라는 의미가 있습니다. 왜 갑자기 뜬금없이 float 라는 단어가 나왔을까요? 실제로 컴퓨터가 실수를 저장하는 방법으로 `부동 소수점` 방식을 사용하기 때문입니다.

double 이란 이름은 마찬가지로 조금 어이없게도 float 의 2배의 용량을 저장하기 때문에 double 이라는 이름이 붙었다고 합니다. 마찬가지로 `부동 소수점` 방식을 사용하죠.

# 변수가 동작하는 과정?

지금까지의 글에서 자료형 별 이름, 데이터 크기, 범위 등을 알아보았습니다. 이름의 유래도 알아보았죠. 근데 뜬금없이 `부동 소수점` 이라는 키워드가 나왔습니다. 데이터 타입에 따라 메모리에 데이터가 할당되는 양상은 조금씩 달라집니다.

변수 타입별로 메모리에 할당되는 형태가 조금 씩은 다르지만, 공통적으로 변수는 자료형 마다 할당 된 데이터 크기 만큼의 메모리 용량을 할당받을 수 있습니다.

그럼 공통적으로 변수가 선언되고 데이터가 할당될 때 무슨 일이 벌어질까요? 우선 이 이야기를 하기 전에 애플리케이션의 메모리 구조에 대해 이야기 해 보아야 합니다.

이 영역은 언어마다 조금 씩 다릅니다. C는 크게 코드영역, 데이터영역, 스택영역, 힙 영역으로 나뉩니다. Java 는 메소드 영역, 힙 영역, 스택 영역, PC 레지스터, 네이티브 메모리 등으로 나뉘죠. 여기서 개발자가 관여할 수 있는 영역은 공통적으로 힙 영역입니다. 단, Java의 경우 원시타입 (Primitive) 은 스택 영역에 쌓입니다.

왜 이 이야기가 나왔느냐면, 공통적으로 어떤 언어를 쓰든 변수를 선언한다는 건 애플리케이션 프로세스에 할당 된 메모리의 특정 영역을 사용한다는 의미이기 때문입니다. 변수의 동작 과정에 대해 이야기 하기 전에 정확히 어떤 지점에 할당되는 지를 짚고 가고 싶었어요.

```kotlin
val age : Int = 10
```

이 코드 한줄로 인해 어떤 일이 벌어지는걸까요?

우선 메모리주소가 할당됩니다. 그리고 자료형에 맞는 영역 크기만큼 용량이 할당됩니다. 만약 우리가 자료형에 잘못 된 데이터를 할당한다면 아마 경험 해 보셨겠지만, 컴파일러 단에서 막힐 수 있습니다. 빌드가 전혀 될 수 없죠. **자료형에 맞는 영역 크기 만큼 용량이 할당된다고 했죠.** 해당 용량을 초과하는 데이터 혹은 자료형에 맞지 않는 형태의 데이터가 할당되면 심각한 에러가 발생할 수 있습니다.

컴파일러는 코드를 빌드하기 전, 이런 잘못된 데이터 할당 값들을 모두 검사합니다. 어쩐지 이상한 코드를 작성하면 에러가 발생했었죠?

아까 메모리주소가 할당되었다고 했죠? 실제로 컴퓨터는 변수의 이름이 어떻든 그다지 관심이 없습니다. 사람 입장에선 당연히 변수에 의미를 부여하는 게 중요하지만, 컴퓨터는 `asdf1`, `asdf2` 이런 식으로 이름을 붙혀도 하등 상관이 없죠. 실제로 소스코드가 컴파일 되면, 변수 이름과 메모리주소와 매핑 된 심볼테이블이 생성됩니다. 그 이후엔 변수에 할당 된 메모리 주소를 통해 데이터에 접근하죠. 

Java 를 사용하는 경우엔 GC (Garbage Collector) 가 알아서 사용하지 않는 변수들을 메모리에서 정리합니다. 만약 특정한 인스턴스를 다시 생성하게 된다면, 그 때 다시 메모리에 변수를 할당시킵니다. 

요약하면, 변수는 애플리케이션 프로세스에 할당 된 메모리 영역에 할당됩니다. 변수명에 매핑 된 심볼 테이블을 통해 실제 데이터에 접근하게 되고 심볼 테이블엔 메모리주소가 지정 되어있습니다. 
